547a0d34dba2d56a373d8440201efc92
"use strict";
/**
 * Debug test file - minimal test for quick iteration
 */
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("../index");
// Increase timeout for WASM initialization
jest.setTimeout(30000);
describe('Debug Formatter Tests', () => {
    beforeAll(async () => {
        await (0, index_1.initFormatter)();
    });
    it('should be idempotent - nested module in block', async () => {
        const input = `module helpers() {
    module line() color("Black") cylinder(r=1, h=10, center=true);

    scale(0.5) {
        cube(10);
    }
}`;
        const once = await (0, index_1.formatOpenScadCode)(input);
        const twice = await (0, index_1.formatOpenScadCode)(once);
        console.log('\n=== IDEMPOTENCE DEBUG ===');
        console.log('Input:', JSON.stringify(input));
        console.log('Once:', JSON.stringify(once));
        console.log('Twice:', JSON.stringify(twice));
        const onceLines = once.split('\n');
        const twiceLines = twice.split('\n');
        console.log('\n=== LINE COMPARISON ===');
        const maxLines = Math.max(onceLines.length, twiceLines.length);
        for (let i = 0; i < maxLines; i++) {
            if (onceLines[i] !== twiceLines[i]) {
                console.log(`Line ${i + 1} DIFFERS:`);
                console.log(`  Once:  ${JSON.stringify(onceLines[i] || '(missing)')}`);
                console.log(`  Twice: ${JSON.stringify(twiceLines[i] || '(missing)')}`);
            }
        }
        expect(twice).toBe(once);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3phY2hhcnltYXJpb24vc3JjL29wZW5zY2FkLXRhdXJpL2FwcHMvdWkvc3JjL3V0aWxzL2Zvcm1hdHRlci9fX3Rlc3RzX18vZGVidWcudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgsb0NBQTZEO0FBRTdELDJDQUEyQztBQUMzQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRXZCLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDckMsU0FBUyxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ25CLE1BQU0sSUFBQSxxQkFBYSxHQUFFLENBQUM7SUFDeEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsK0NBQStDLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDN0QsTUFBTSxLQUFLLEdBQUc7Ozs7OztFQU1oQixDQUFDO1FBRUMsTUFBTSxJQUFJLEdBQUcsTUFBTSxJQUFBLDBCQUFrQixFQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdDLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBQSwwQkFBa0IsRUFBQyxJQUFJLENBQUMsQ0FBQztRQUU3QyxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7UUFDM0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzdDLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUMzQyxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFFN0MsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuQyxNQUFNLFVBQVUsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXJDLE9BQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUN6QyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQy9ELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUNsQyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUN2RSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzFFLENBQUM7UUFDSCxDQUFDO1FBRUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy96YWNoYXJ5bWFyaW9uL3NyYy9vcGVuc2NhZC10YXVyaS9hcHBzL3VpL3NyYy91dGlscy9mb3JtYXR0ZXIvX190ZXN0c19fL2RlYnVnLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWJ1ZyB0ZXN0IGZpbGUgLSBtaW5pbWFsIHRlc3QgZm9yIHF1aWNrIGl0ZXJhdGlvblxuICovXG5cbmltcG9ydCB7IGZvcm1hdE9wZW5TY2FkQ29kZSwgaW5pdEZvcm1hdHRlciB9IGZyb20gJy4uL2luZGV4JztcblxuLy8gSW5jcmVhc2UgdGltZW91dCBmb3IgV0FTTSBpbml0aWFsaXphdGlvblxuamVzdC5zZXRUaW1lb3V0KDMwMDAwKTtcblxuZGVzY3JpYmUoJ0RlYnVnIEZvcm1hdHRlciBUZXN0cycsICgpID0+IHtcbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBpbml0Rm9ybWF0dGVyKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgaWRlbXBvdGVudCAtIG5lc3RlZCBtb2R1bGUgaW4gYmxvY2snLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgaW5wdXQgPSBgbW9kdWxlIGhlbHBlcnMoKSB7XG4gICAgbW9kdWxlIGxpbmUoKSBjb2xvcihcIkJsYWNrXCIpIGN5bGluZGVyKHI9MSwgaD0xMCwgY2VudGVyPXRydWUpO1xuXG4gICAgc2NhbGUoMC41KSB7XG4gICAgICAgIGN1YmUoMTApO1xuICAgIH1cbn1gO1xuXG4gICAgY29uc3Qgb25jZSA9IGF3YWl0IGZvcm1hdE9wZW5TY2FkQ29kZShpbnB1dCk7XG4gICAgY29uc3QgdHdpY2UgPSBhd2FpdCBmb3JtYXRPcGVuU2NhZENvZGUob25jZSk7XG5cbiAgICBjb25zb2xlLmxvZygnXFxuPT09IElERU1QT1RFTkNFIERFQlVHID09PScpO1xuICAgIGNvbnNvbGUubG9nKCdJbnB1dDonLCBKU09OLnN0cmluZ2lmeShpbnB1dCkpO1xuICAgIGNvbnNvbGUubG9nKCdPbmNlOicsIEpTT04uc3RyaW5naWZ5KG9uY2UpKTtcbiAgICBjb25zb2xlLmxvZygnVHdpY2U6JywgSlNPTi5zdHJpbmdpZnkodHdpY2UpKTtcblxuICAgIGNvbnN0IG9uY2VMaW5lcyA9IG9uY2Uuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IHR3aWNlTGluZXMgPSB0d2ljZS5zcGxpdCgnXFxuJyk7XG5cbiAgICBjb25zb2xlLmxvZygnXFxuPT09IExJTkUgQ09NUEFSSVNPTiA9PT0nKTtcbiAgICBjb25zdCBtYXhMaW5lcyA9IE1hdGgubWF4KG9uY2VMaW5lcy5sZW5ndGgsIHR3aWNlTGluZXMubGVuZ3RoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heExpbmVzOyBpKyspIHtcbiAgICAgIGlmIChvbmNlTGluZXNbaV0gIT09IHR3aWNlTGluZXNbaV0pIHtcbiAgICAgICAgY29uc29sZS5sb2coYExpbmUgJHtpICsgMX0gRElGRkVSUzpgKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgT25jZTogICR7SlNPTi5zdHJpbmdpZnkob25jZUxpbmVzW2ldIHx8ICcobWlzc2luZyknKX1gKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgVHdpY2U6ICR7SlNPTi5zdHJpbmdpZnkodHdpY2VMaW5lc1tpXSB8fCAnKG1pc3NpbmcpJyl9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZXhwZWN0KHR3aWNlKS50b0JlKG9uY2UpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9